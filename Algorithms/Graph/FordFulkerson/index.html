



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Solutions to Competitive Programming Problems">
      
      
        <link rel="canonical" href="https://icpc.ninja/Algorithms/Graph/FordFulkerson/">
      
      
        <meta name="author" content="JCHRYS">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Ford-Fulkerson - ICPC.NINJA</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/katex.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-144755317-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ford-fulkerson_algorithm" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://icpc.ninja" title="ICPC.NINJA" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              ICPC.NINJA
            </span>
            <span class="md-header-nav__topic">
              
                Ford-Fulkerson
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/jchrys/icpc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jchrys/icpc
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://icpc.ninja" title="ICPC.NINJA" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    ICPC.NINJA
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/jchrys/icpc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jchrys/icpc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Algorithms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Algorithms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      Graph
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Graph
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GraphTraversal/" title="Graph Traversal" class="md-nav__link">
      Graph Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DirectedGraphs/" title="Directed Graphs" class="md-nav__link">
      Directed Graphs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../StrongConnectivity/" title="Strong Connectivity" class="md-nav__link">
      Strong Connectivity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-5" type="checkbox" id="nav-2-1-5">
    
    <label class="md-nav__link" for="nav-2-1-5">
      Shortest Paths
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-5">
        Shortest Paths
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ShortestPaths/Preface/" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ShortestPaths/Bellman-Ford/" title="Bellman-Ford" class="md-nav__link">
      Bellman-Ford
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ShortestPaths/Dijkstra/" title="Dijkstra" class="md-nav__link">
      Dijkstra
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ShortestPaths/Floyd-Warshall/" title="Floyd-Warshall" class="md-nav__link">
      Floyd-Warshall
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EulerianPaths/" title="Eulerian Paths" class="md-nav__link">
      Eulerian Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HamiltonianPaths/" title="Hamiltonian Paths" class="md-nav__link">
      Hamiltonian Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DeBruijnSequences/" title="De Bruijn sequences" class="md-nav__link">
      De Bruijn sequences
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../KnightsTours/" title="Knight's tours" class="md-nav__link">
      Knight's tours
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MaximumFlow/" title="Maximum flow" class="md-nav__link">
      Maximum flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MinimumCut/" title="Minimum cut" class="md-nav__link">
      Minimum cut
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ford-Fulkerson
      </label>
    
    <a href="./" title="Ford-Fulkerson" class="md-nav__link md-nav__link--active">
      Ford-Fulkerson
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#algorithm_description" title="Algorithm description" class="md-nav__link">
    Algorithm description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finding_paths" title="Finding paths" class="md-nav__link">
    Finding paths
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#path_finding_techniques" title="Path finding techniques" class="md-nav__link">
    Path finding techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edmond-karp_algorithm" title="Edmond-Karp algorithm" class="md-nav__link">
    Edmond-Karp algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling_algorithm" title="Scaling algorithm" class="md-nav__link">
    Scaling algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dinic_algorithm" title="Dinic Algorithm" class="md-nav__link">
    Dinic Algorithm
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation_dinic_with_scaling" title="Implementation (Dinic with Scaling)" class="md-nav__link">
    Implementation (Dinic with Scaling)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems" title="Problems" class="md-nav__link">
    Problems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related_topics" title="Related topics" class="md-nav__link">
    Related topics
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DisjointPaths/" title="Disjoint Paths" class="md-nav__link">
      Disjoint Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MaximumMatchings/" title="Maximum Matchings" class="md-nav__link">
      Maximum Matchings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../KonigsTheorem/" title="Konig's Theorem" class="md-nav__link">
      Konig's Theorem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../PathCovers/" title="Path Covers" class="md-nav__link">
      Path Covers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      DFS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        DFS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../DFS/Preface/" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DFS/Tree/" title="DFSTree" class="md-nav__link">
      DFSTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DFS/StartingFinishingTime/" title="StartingFinishingTime" class="md-nav__link">
      StartingFinishingTime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DFS/FindingCutEdges/" title="FindingCutEdges" class="md-nav__link">
      FindingCutEdges
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Tree
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Tree
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Tree/Basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Tree/Traversal/" title="Traversal" class="md-nav__link">
      Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Tree/DP/" title="DP" class="md-nav__link">
      DP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Tree/SpanningTree/" title="SpanningTree" class="md-nav__link">
      SpanningTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Tree/TreeQueries/" title="TreeQueries" class="md-nav__link">
      TreeQueries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Sort
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Sort
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Sort/InsertionSort/" title="InsertionSort" class="md-nav__link">
      InsertionSort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Sort/BubbleSort/" title="BubbleSort" class="md-nav__link">
      BubbleSort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Sort/HeapSort/" title="HeapSort" class="md-nav__link">
      HeapSort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Sort/QuickSort/" title="QuickSort" class="md-nav__link">
      QuickSort
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../EuclideanAlgorithm/" title="Euclidean" class="md-nav__link">
      Euclidean
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Linear
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        Linear
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Linear/BinarySearch/" title="BinarySearch" class="md-nav__link">
      BinarySearch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Linear/LowerAndUpperBounds/" title="Lower and Upper Bounds" class="md-nav__link">
      Lower and Upper Bounds
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      String
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        String
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../String/Preface/" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../String/StringHashing/" title="String Hashing" class="md-nav__link">
      String Hashing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../String/Trie/" title="Trie" class="md-nav__link">
      Trie
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../String/Z-Algorithm/" title="Z-Algorithm" class="md-nav__link">
      Z-Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../String/KMP-Algorithm/" title="KMP-Algorithm" class="md-nav__link">
      KMP-Algorithm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8">
    
    <label class="md-nav__link" for="nav-2-8">
      Range Queries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        Range Queries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../RangeQueries/Preface/" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../RangeQueries/StaticArrayQueries/" title="StaticArrayQueries" class="md-nav__link">
      StaticArrayQueries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Bit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        Bit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Bit/FastPower/" title="FastPower" class="md-nav__link">
      FastPower
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Bit/BitManipulation/" title="BitManipulation" class="md-nav__link">
      BitManipulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      NumberTheory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        NumberTheory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../NumberTheory/MobiusInversion/" title="MobiusInversion" class="md-nav__link">
      MobiusInversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NumberTheory/Theorems/" title="Theorems" class="md-nav__link">
      Theorems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      DataStructures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        DataStructures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Linear
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Linear
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Linear/Stack/" title="Stack" class="md-nav__link">
      Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Linear/Vector/" title="Vector" class="md-nav__link">
      Vector
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Linear/Heap/" title="Heap" class="md-nav__link">
      Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Linear/LinkedList/" title="Linked List" class="md-nav__link">
      Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Linear/Pair/" title="Pair" class="md-nav__link">
      Pair
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Hash Tables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Hash Tables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/HashTables/Preface/" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/HashTables/HashFunctions/" title="Hash Functions" class="md-nav__link">
      Hash Functions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Trees
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Trees
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Trees/SearchTree/" title="SearchTree" class="md-nav__link">
      SearchTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Trees/BST/" title="BST" class="md-nav__link">
      BST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Trees/RedBlackTree/" title="RedBlackTree" class="md-nav__link">
      RedBlackTree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Trees/BinaryIndexedTree/" title="Binary Indexed Tree" class="md-nav__link">
      Binary Indexed Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../DataStructures/Trees/SegmentTree/" title="Segment Tree" class="md-nav__link">
      Segment Tree
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MISC/Lemma/" title="Lemma" class="md-nav__link">
      Lemma
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Language
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Language
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Language/Preface/" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Language/Keywords/" title="Keywords" class="md-nav__link">
      Keywords
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Language/Class/" title="Class" class="md-nav__link">
      Class
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Contribute
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Contribute
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Contribute/HowToContribute/" title="HowToContribute" class="md-nav__link">
      HowToContribute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Contribute/CodeOfConduct/" title="CodeOfConduct" class="md-nav__link">
      CodeOfConduct
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Contribute/Template/" title="Template" class="md-nav__link">
      Template
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Contribute/Emoji/" title="Emoji" class="md-nav__link">
      Emoji
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#algorithm_description" title="Algorithm description" class="md-nav__link">
    Algorithm description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finding_paths" title="Finding paths" class="md-nav__link">
    Finding paths
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#path_finding_techniques" title="Path finding techniques" class="md-nav__link">
    Path finding techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edmond-karp_algorithm" title="Edmond-Karp algorithm" class="md-nav__link">
    Edmond-Karp algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling_algorithm" title="Scaling algorithm" class="md-nav__link">
    Scaling algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dinic_algorithm" title="Dinic Algorithm" class="md-nav__link">
    Dinic Algorithm
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation_dinic_with_scaling" title="Implementation (Dinic with Scaling)" class="md-nav__link">
    Implementation (Dinic with Scaling)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems" title="Problems" class="md-nav__link">
    Problems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related_topics" title="Related topics" class="md-nav__link">
    Related topics
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jchrys/icpc/edit/master/docs/Algorithms/Graph/FordFulkerson.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="ford-fulkerson_algorithm">Ford-Fulkerson algorithm<a class="headerlink" href="#ford-fulkerson_algorithm" title="Permanent link">&para;</a></h1>
<blockquote>
<p>The Ford-Fulkerson algorithm finds the maximum flow in a graph.</p>
<p>The algorithm begins with an empty flow, and at each step finds a path from the source to the sink that generates more flow.</p>
<p>Finally, when the algorithm cannot increase the flow anymore, the maximum flow has been found.</p>
<p><mark>The algorithm uses a special representation of the graph where each original edge has a reverse edge in another direction.</mark></p>
<p>The weight of each edge indicates how much more flow we could route through it.</p>
<p>At the beginning of the algorithm, the weight of each original edge equals the capacity of the edge and the weight of each reverse edge is zero.</p>
</blockquote>
<h2 id="algorithm_description">Algorithm description<a class="headerlink" href="#algorithm_description" title="Permanent link">&para;</a></h2>
<blockquote>
<p>The Ford-Fulkerson algorithm consists of several rounds.</p>
<p>On each round, the algorithm finds a path from the source to the sink such that each edge on the path has a positive weight.</p>
<p>If there is more than one possible path available, we can choose any of them.</p>
<p>After choosing the path, the flow increases by $x$ units, where $x$ is the smallest edge weight on the path.</p>
<p>In addition, the weight of each edge on the path decreases by $x$ and the weight of each reverse edge increases by $x$.</p>
<p><mark>The idea is that increasing the flow decreases the amount of flow that can go through the edges in the future.</mark></p>
<p>On the other hand, it is possible to cancel flow later using the reverse edges of the graph if it turns out that it would be beneficial to route the flow in another way.</p>
<p>The algorithm increases the flow as long as there is a path from the source to the sink through positive-weight edges. </p>
<p>If It is not possible to increase the flow anymore, because there is no path from the source to the sink with positive edge weights, the algorithm terminates and has found the maximum flow.</p>
</blockquote>
<h2 id="finding_paths">Finding paths<a class="headerlink" href="#finding_paths" title="Permanent link">&para;</a></h2>
<blockquote>
<p>The Ford-Fulkerson algorithm does not specify how we should choose the paths that increase the flow.</p>
<p>In any case, the algorithm will terminate sooner or later and correctly find the maximum flow. </p>
<p><mark>However, the efficiency of the algorithm depends on the way the paths are chosen.</mark></p>
</blockquote>
<h2 id="path_finding_techniques">Path finding techniques<a class="headerlink" href="#path_finding_techniques" title="Permanent link">&para;</a></h2>
<blockquote>
<p>In practive, <mark>the scaling algorithm is easier to implement</mark>, because depth-first search can be used for finding paths.</p>
<p>Both Algorithms are efficient enough for problems that typically appear in programming contests.</p>
</blockquote>
<h3 id="edmond-karp_algorithm">Edmond-Karp algorithm<a class="headerlink" href="#edmond-karp_algorithm" title="Permanent link">&para;</a></h3>
<blockquote>
<p><mark>The algorithm chooses each path so that the number of edges on the path is as small as possible.</mark></p>
<p>This can be done by using $\text{breadth-first search}$ instead of depth-first search for finding paths.</p>
<p>It can be proven that this guarantees that the flow increases quickly, and the <mark>time complexity of the algorithm is $\Omicron(m^2n)$.</mark></p>
</blockquote>
<h3 id="scaling_algorithm">Scaling algorithm<a class="headerlink" href="#scaling_algorithm" title="Permanent link">&para;</a></h3>
<blockquote>
<p><mark>The algorithm uses depth-first search to find paths where each weight is at least a threshold value.</mark></p>
<p>Initially, the threshold value is some large number, for example the sum of all edge weights of the graph.</p>
<p>Always when a path cannot be found, the threshold value is divided by 2.</p>
<p><mark>The time complexity of the algorithm is $\Omicron(m^2lgc)$</mark>, where $c$ is the initial threshold value.</p>
</blockquote>
<h3 id="dinic_algorithm">Dinic Algorithm<a class="headerlink" href="#dinic_algorithm" title="Permanent link">&para;</a></h3>
<blockquote>
<p>Time complex $\Omicron(EV^2)$</p>
<p>Like Edmond-Karp algorithm, Dinic's algorithm uses following concepts</p>
</blockquote>
<ol>
<li>
<p>A flow is maximum if there is no $source$ to $sink$ path in residual graph.</p>
</li>
<li>
<p>$\text{BFS}$ is used in a loop. There is difference though in the way we use BFS in both algorithms.</p>
</li>
</ol>
<blockquote>
<p>In Edmond's Karp algorithm, we use $\text{BFS}$ to find a augmenting path and send flow accress this path.</p>
<p>In Dinic's algorithm we use $\text{BFS}$ to check if more flow is possible and to construct level graph. </p>
<p>In, level graph, we assign levels to all nodes, level of a node is shortest distance (in terms of number of edges) of the node from source. </p>
<p>Once level graph is constructed, we send multiple flows using this level graph.</p>
<p>This is the reason it works better than Edmond-Karp.</p>
<p>In Edmond-Karp, we send only flow that is send across the path found by BFS.</p>
</blockquote>
<h2 id="implementation_dinic_with_scaling">Implementation (Dinic with Scaling)<a class="headerlink" href="#implementation_dinic_with_scaling" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cm">/********************************************************************************</span>
<span class="cm">    MaxFlow Dinic algorithm with scaling. </span>
<span class="cm">    O(N * M * log(MC)), where MC is maximum edge capacity.</span>

<span class="cm">    Based on problem 2784 from informatics.mccme.ru </span>
<span class="cm">    http://informatics.mccme.ru/mod/statements/view3.php?chapterid=2784#1</span>
<span class="cm">********************************************************************************/</span>

<span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">edge</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">inf</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">1050</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">edge</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">pt</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span> <span class="c1">// very important performance trick</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">flow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">d</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">lim</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">add_edge</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>                                                                           
    <span class="n">edge</span> <span class="n">ed</span><span class="p">;</span>

    <span class="c1">//keep edges in vector: e[ind] - direct edge, e[ind ^ 1] - back edge </span>

    <span class="n">ed</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="n">ed</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">ed</span><span class="p">.</span><span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ed</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
    <span class="n">e</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>

    <span class="n">ed</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">ed</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="n">ed</span><span class="p">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span> <span class="n">ed</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">b</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
    <span class="n">e</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">bfs</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span><span class="p">;</span>
    <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">inf</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">g</span><span class="p">[</span><span class="n">cur</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">cur</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
            <span class="kt">int</span> <span class="n">to</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">b</span><span class="p">;</span>

            <span class="c1">//printf(&quot;cur = %d id = %d a = %d b = %d f = %d c = %d\n&quot;, cur, id, e[id].a, e[id].b, e[id].f, e[id].c);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">==</span> <span class="n">inf</span> <span class="o">&amp;&amp;</span> <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">c</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">f</span> <span class="o">&gt;=</span> <span class="n">lim</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">to</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> 
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">!=</span> <span class="n">inf</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flow</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">flow</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> 
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//cout &lt;&lt; v &lt;&lt; endl;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(;</span> <span class="n">pt</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="n">pt</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">pt</span><span class="p">[</span><span class="n">v</span><span class="p">]];</span>
        <span class="kt">int</span> <span class="n">to</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">b</span><span class="p">;</span>

        <span class="c1">//printf(&quot;v = %d id = %d a = %d b = %d f = %d c = %d\n&quot;, v, id, e[id].a, e[id].b, e[id].f, e[id].c);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">==</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">c</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">f</span> <span class="o">&gt;=</span> <span class="n">flow</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">pushed</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">flow</span><span class="p">);</span> 
            <span class="k">if</span> <span class="p">(</span><span class="n">pushed</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">e</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">f</span> <span class="o">+=</span> <span class="n">flow</span><span class="p">;</span>
                <span class="n">e</span><span class="p">[</span><span class="n">id</span> <span class="o">^</span> <span class="mi">1</span><span class="p">].</span><span class="n">f</span> <span class="o">-=</span> <span class="n">flow</span><span class="p">;</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>               
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">dinic</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">lim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">30</span><span class="p">);</span> <span class="n">lim</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bfs</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">lim</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> 
            <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">pushed</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">pushed</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">lim</span><span class="p">))</span> <span class="p">{</span> 
            <span class="n">flow</span> <span class="o">=</span> <span class="n">flow</span> <span class="o">+</span> <span class="n">lim</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">//cout &lt;&lt; flow &lt;&lt; endl;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//freopen(&quot;input.txt&quot;,&quot;r&quot;,stdin);</span>
    <span class="c1">//freopen(&quot;output.txt&quot;,&quot;w&quot;,stdout);</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d %d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>

    <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d %d %d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">);</span>
        <span class="n">add_edge</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">dinic</span><span class="p">();</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">flow</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="problems">Problems<a class="headerlink" href="#problems" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="https://www.acmicpc.net/problem/6086">최대 유량</a><img align="absmiddle" alt=":star:" class="gemoji" height="20px" src="https://github.com/images/icons/emoji/unicode/2b50.png" title=":star:" width="20px" /><img align="absmiddle" alt=":star:" class="gemoji" height="20px" src="https://github.com/images/icons/emoji/unicode/2b50.png" title=":star:" width="20px" /><img align="absmiddle" alt=":star:" class="gemoji" height="20px" src="https://github.com/images/icons/emoji/unicode/2b50.png" title=":star:" width="20px" /></li>
</ol>
<h2 id="related_topics">Related topics<a class="headerlink" href="#related_topics" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="/Algorithms/Graph/MaximumFlow">Maximum flow</a></li>
<li><a href="/Algorithms/Graph/MinimumCut">Minimum cut</a></li>
</ul>
                
                  
                
              
              
                


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://icpc.ninja/Algorithms/Graph/FordFulkerson/";
      this.page.identifier =
        "/Algorithms/Graph/FordFulkerson/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//icpcninja.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../MinimumCut/" title="Minimum cut" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Minimum cut
              </span>
            </div>
          </a>
        
        
          <a href="../DisjointPaths/" title="Disjoint Paths" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Disjoint Paths
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            jchrys &copy;2019~
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>